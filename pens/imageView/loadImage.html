<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>图片预览</title>

</head>
<body>

<div class="container">

  <div class="p-wrap">
    <div class="action">
      <input type="file" id="file"/>
      <button id="btnview">预览</button>
    </div>
    <figure class="preview">
      <img alt="" src="" id="imgview" />
    </figure>
  </div>

  <script>
    function $(selector){
      return document.querySelectorAll(selector);
    }

    document.body.onload = function(){
      var btnview = $('#btnview')[0];
      var file    = $('#file')[0];
      var imgview = $('#imgview')[0];

      imgview.onerror = function () {
        alert('错误： ' + '图像大小过大或图像异常！');
      };

      var fileSelectedHandle = function(){
        handleFileSelected({
          obj: file,
          success: function(dataUrl){
            imgview.setAttribute('src', dataUrl);
          },
          error: function(ex){
            alert(ex.message);
          }
        });
      };

      //以下内容可以选择后自动显示
      file.onchange = function () {
        fileSelectedHandle();
      };
      // 点击预览
      btnview.onclick = function () {
        fileSelectedHandle();
      };

    };

  </script>

</div>

<script src="loadImage.js"></script>
</body>
</html>
